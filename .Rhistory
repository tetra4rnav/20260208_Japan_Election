x = "自民党 獲得議席数（小選挙区）",
y = "自民党 得票数（百万票）",
caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_voter,
p_seat_jimin = seat_jimin / seat_total
)
ggplot2(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
) +
geom_text(
vjust = -1,
size = 3
) +
labs(
title = "自民党：小選挙区の獲得議席数と得票数",
x = "自民党 獲得議席数（小選挙区）",
y = "自民党 得票数（百万票）",
caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_voter,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
) +
geom_text(
vjust = -1,
size = 3
) +
labs(
title = "自民党：小選挙区の獲得議席数と得票数",
x = "自民党 獲得議席数（小選挙区）",
y = "自民党 得票数（百万票）",
caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
View(df)
library(tidyverse)
library(dplyr)
df<-read.csv("partybalot.csv")
df
str(df)
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_voter,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
) +
geom_text(
vjust = -1,
size = 3
) +
labs(
title = "自民党：小選挙区の獲得議席数と得票数",
x = "自民党 獲得議席数（小選挙区）",
y = "自民党 得票数（百万票）",
caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_voter,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
#  caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
#  caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7
fullrange = TRUE
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
#  caption = "※ データ点が少ないため回帰は参考程度"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
caption = "※ データ点が少ないため回帰は参考程度(外挿)"
) +
theme_minimal(base_size = 12)
plot1
View(df)
df <- df %>%
mutate(
p_vote_precise = n_balot / n_voter,
p_osvote_precise = n_osbalot / n_osvoters
)
library(tidyverse)
library(dplyr)
df<-read.csv("partybalot.csv")
df
str(df)
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
caption = "※ データ点が少ないため回帰は参考程度(外挿)"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
p_vote_precise = n_balot / n_voter,
p_osvote_precise = n_osbalot / n_osvoters
)
plot2 <- ggplot(
df,
aes(
x=p_vote_precise,
y=p_osvote_precise,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
labs(
title = "衆院選 投票率(小選挙区・全体)と在外投票率との関係",
x = "投票率",
y = "在外投票率",
caption = "※ データ点が少ないため回帰は参考程度(外挿)"
) +
theme_minimal(base_size = 12)
plot2
cor.test(df$p_vote_precise, df$p_osvote_precise, method = "pearson")
#pearson
cor.test(df$p_vote_precise, df$p_osvote_precise, method = "pearson")
#spearman
cor.test(df$p_vote_precise, df$p_osvote_precise, method = "spearman")
tinytex::is_tinytex()
tinytex::tlmgr_path()
library(tidyverse)
library(dplyr)
df<-read.csv("partybalot.csv")
df
str(df)
df <- df %>%
mutate(
balot_jimin = as.numeric(as.character(balot_jimin)),
n_voter     = as.numeric(as.character(n_voter))
) %>%
mutate(
p_jimin = balot_jimin / n_balot,
p_seat_jimin = seat_jimin / seat_total
)
plot1 <- ggplot(
df,
aes(
x=p_seat_jimin,
y=p_jimin,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
scale_x_continuous(
limits = c(0, 1),
labels = scales::percent
) +
scale_y_continuous(
limits = c(0, 1),
labels = scales::percent
) +
labs(
title = "衆院選 自民党得票率(小選挙区)と議席獲得率の関係",
x = "自民党 議席獲得率（小選挙区）",
y = "自民党 得票率 (得票数/投票数)",
caption = "※ データ点が少ないため回帰は参考程度(外挿)"
) +
theme_minimal(base_size = 12)
plot1
df <- df %>%
mutate(
p_vote_precise = n_balot / n_voter,
p_osvote_precise = n_osbalot / n_osvoters
)
plot2 <- ggplot(
df,
aes(
x=p_vote_precise,
y=p_osvote_precise,
label=year
)
)+
geom_point(size = 3) +
geom_smooth(
method = "lm",
se = FALSE,
linewidth = 0.7,
fullrange = TRUE
) +
geom_text(
vjust = -1,
size = 3
) +
labs(
title = "衆院選 投票率(小選挙区・全体)と在外投票率との関係",
x = "投票率",
y = "在外投票率",
caption = "※ データ点が少ないため回帰は参考程度(外挿)"
) +
theme_minimal(base_size = 12)
plot2
#pearson
cor.test(df$p_vote_precise, df$p_osvote_precise, method = "pearson")
#spearman
cor.test(df$p_vote_precise, df$p_osvote_precise, method = "spearman")
Sys.which("lualatex")
system("fc-list :lang=ja | findstr /i \"Noto Yu MS\"")
install.packages(c("showtext", "sysfonts"))
library(showtext)
library(sysfonts)
library(tidyverse)
library(dplyr)
font_add("jp", "Yu Mincho")
library(showtext)
library(sysfonts)
library(tidyverse)
library(dplyr)
font_add("jp", "Yu Gothic")
library(showtext)
library(sysfonts)
library(tidyverse)
library(dplyr)
showtext_auto()
df<-read.csv("partybalot.csv")
df
str(df)
